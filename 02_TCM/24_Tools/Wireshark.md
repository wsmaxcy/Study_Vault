## Overview
Wireshark is a free and open-source packet analyzer used for network troubleshooting, analysis, software and protocol development, and education. It allows users to capture and interactively browse the traffic running on a computer network. Due to its ability to capture and analyze network traffic, Wireshark is widely used in cybersecurity for network forensics, intrusion detection, and security assessments.

## Features
- **Packet Capture:** Captures live network traffic from a network interface.
- **Protocol Analysis:** Supports deep inspection of hundreds of protocols, with more added all the time.
- **Filtering and Search:** Powerful display filters to refine captured data.
- **Reassembly of Streams:** Can reassemble TCP sessions and view the data as it was transmitted.
- **Color Coding:** Colorizes packet display based on filters to highlight different types of traffic.
- **Cross-Platform:** Runs on various operating systems, including Windows, macOS, and Linux.

## Website
- [Wireshark Official Website](https://www.wireshark.org/)

## Installation

### On Unix-based systems (Linux/macOS):
1. **Install Wireshark:**
   - On Debian-based systems:
```sh
sudo apt-get install wireshark
```
   - On Red Hat-based systems:
```sh
sudo yum install wireshark
```
   - On macOS using Homebrew:
```sh
brew install wireshark
```

### On Windows:
1. **Download Installer:**
   - Download the Wireshark installer from the [Wireshark Download Page](https://www.wireshark.org/download.html).

2. **Run Installer:**
   - Follow the installation instructions to install Wireshark and the necessary drivers.

## Basic Usage
Wireshark can be used to capture, filter, and analyze network traffic. Here are some common tasks and usage examples:

### Start a Packet Capture
1. **Open Wireshark:**
   - Start Wireshark from your applications menu or start menu.

2. **Select Network Interface:**
   - Choose the network interface to capture from (e.g., Ethernet, Wi-Fi).

3. **Start Capturing:**
   - Click the blue shark fin button or press `Ctrl+E` to start capturing packets.

### Apply Display Filters
- To filter HTTP traffic:
```wireshark
http
```

- To filter TCP traffic from a specific IP:
```wireshark
tcp.src == 192.168.1.1
```

- To filter packets containing a specific string:
```wireshark
frame contains "password"
```

### Analyze Packets
1. **Inspect Individual Packets:**
   - Click on any packet in the packet list to see its details.

2. **Follow TCP/UDP Stream:**
   - Right-click on a packet and select "Follow" > "TCP Stream" or "UDP Stream" to view the conversation.

### Save Captures
To save captured packets to a file:
1. **Stop Capture:**
   - Click the red square button or press `Ctrl+E` to stop capturing.

2. **Save Capture File:**
   - Go to `File` > `Save As` and choose a location and file format (e.g., .pcapng).

## Advanced Features
Wireshark offers several advanced features for more specific use cases:

### Decrypting SSL/TLS Traffic
- **Install Necessary Keys:**
  - Configure Wireshark with the appropriate private keys to decrypt SSL/TLS traffic.

- **Use SSLKEYLOGFILE Environment Variable:**
  - Set the `SSLKEYLOGFILE` environment variable to log keys for HTTPS decryption.

### Analyzing Malicious Traffic
- **Use Protocol Hierarchy:**
  - Go to `Statistics` > `Protocol Hierarchy` to view a breakdown of protocols and identify any suspicious activity.

- **Use Expert Information:**
  - Go to `Analyze` > `Expert Information` to view warnings and errors that may indicate malicious behavior.

### Creating Custom Display Filters
- **Combine Filters:**
  - Use `&&` (and), `||` (or), and `!` (not) to combine filters:
```wireshark
http && ip.src == 192.168.1.1
```

- **Save Filters:**
  - Save frequently used filters for quick access under the display filter toolbar.

## Tools for Exploiting and Defending Using Wireshark

- **Network Forensics:** Use Wireshark to analyze traffic patterns, detect anomalies, and reconstruct events during a security incident.
- **Password Sniffing:** Capture unencrypted credentials sent over HTTP, FTP, and other protocols.
- **Malware Analysis:** Investigate malicious traffic generated by malware to understand its behavior and communication methods.
- **Protocol Analysis:** Inspect unknown or custom protocols to identify vulnerabilities or reverse engineer proprietary communications.

## Best Practices
- **Run as Root/Admin Only When Necessary:** Only use root or admin privileges for capturing packets if necessary to avoid security risks.
- **Use Display Filters Wisely:** Apply display filters to focus on relevant traffic and reduce noise.
- **Stay Updated:** Keep Wireshark and its protocol dissectors updated to the latest version to ensure compatibility and security.
- **Anonymize Sensitive Data:** Be mindful of privacy and confidentiality; anonymize sensitive data in captures when sharing.
- **Combine with Other Tools:** Use Wireshark alongside other network tools like [[Nmap.md|Nmap]], [[Tcpdump]], and [[FoxyProxy]] for comprehensive network analysis and penetration testing.

## References
- [Wireshark Official Website](https://www.wireshark.org/)
- [Wireshark User Guide](https://www.wireshark.org/docs/wsug_html_chunked/)
- [Wireshark Display Filter Reference](https://www.wireshark.org/docs/dfref/)

